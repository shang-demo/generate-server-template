{"version":3,"sources":["user-data.js"],"names":["getPath","userDataDir","process","env","APPDATA","platform","HOME","gstPath","setConfig","templateDir","gstConfig","getConfig","gstStr","e","JSON","parse","Error"],"mappings":";;;;;;;;AAAA;;AACA;;AAEA,eAAeA,OAAf,GAAyB;AACvB;AACA,MAAIC,WAAW,GAAGC,OAAO,CAACC,GAAR,CAAYC,OAA9B;;AAEA,MAAI,CAACH,WAAL,EAAkB;AAChB;AACA,QAAIC,OAAO,CAACG,QAAR,KAAqB,QAAzB,EAAmC;AACjCJ,MAAAA,WAAW,GAAG,mBAAYC,OAAO,CAACC,GAAR,CAAYG,IAAxB,EAA8B,qBAA9B,CAAd;AACD,KAFD,CAGA;AAHA,SAIK;AACHL,QAAAA,WAAW,GAAG,YAAd;AACD;AACF;;AAED,MAAIM,OAAO,GAAG,mBAAYN,WAAZ,EAAyB,gCAAzB,CAAd;AACA,SAAOM,OAAP;AACD;;AAED,eAAeC,SAAf,CAAyB;AAAEC,EAAAA;AAAF,CAAzB,EAA0C;AACxC,MAAIF,OAAO,GAAG,MAAMP,OAAO,EAA3B;AACA,MAAIU,SAAS,GAAG,MAAMC,SAAS,CAACJ,OAAD,CAA/B;AACAG,EAAAA,SAAS,CAACD,WAAV,GAAwBA,WAAxB;AACA,QAAM,wBAAUF,OAAV,EAAmBG,SAAnB,CAAN;AACA,SAAOA,SAAP;AACD;;AAED,eAAeC,SAAf,CAAyBJ,OAAzB,EAAkC;AAChC,MAAI,CAACA,OAAL,EAAc;AACZ;AACAA,IAAAA,OAAO,GAAG,MAAMP,OAAO,EAAvB;AACD;;AAED,MAAIY,MAAM,GAAG,EAAb;;AACA,MAAI;AACF,UAAM,mBAAKL,OAAL,CAAN;AACAK,IAAAA,MAAM,GAAG,MAAM,uBAASL,OAAT,CAAf;AACD,GAHD,CAIA,OAAOM,CAAP,EAAU;AACRD,IAAAA,MAAM,GAAG,IAAT;AACD;;AAED,MAAIF,SAAJ;;AACA,MAAI;AACFA,IAAAA,SAAS,GAAGI,IAAI,CAACC,KAAL,CAAWH,MAAX,CAAZ;AACD,GAFD,CAGA,OAAOC,CAAP,EAAU;AACR,UAAM,IAAIG,KAAJ,CAAW,GAAET,OAAQ,wBAArB,CAAN;AACD;;AAED,SAAOG,SAAP;AACD","sourcesContent":["import { stat, readFile, writeJSON } from 'fs-extra';\nimport { resolve as pathResolve } from 'path';\n\nasync function getPath() {\n  // windows\n  let userDataDir = process.env.APPDATA;\n\n  if (!userDataDir) {\n    // mac\n    if (process.platform === 'darwin') {\n      userDataDir = pathResolve(process.env.HOME, 'Library/Preferences');\n    }\n    // linux\n    else {\n      userDataDir = '/var/local';\n    }\n  }\n\n  let gstPath = pathResolve(userDataDir, '.generate-server-template.json');\n  return gstPath;\n}\n\nasync function setConfig({ templateDir }) {\n  let gstPath = await getPath();\n  let gstConfig = await getConfig(gstPath);\n  gstConfig.templateDir = templateDir;\n  await writeJSON(gstPath, gstConfig);\n  return gstConfig;\n}\n\nasync function getConfig(gstPath) {\n  if (!gstPath) {\n    // eslint-disable-next-line no-param-reassign\n    gstPath = await getPath();\n  }\n\n  let gstStr = '';\n  try {\n    await stat(gstPath);\n    gstStr = await readFile(gstPath);\n  }\n  catch (e) {\n    gstStr = '{}';\n  }\n\n  let gstConfig;\n  try {\n    gstConfig = JSON.parse(gstStr);\n  }\n  catch (e) {\n    throw new Error(`${gstPath} is not a valid config`);\n  }\n\n  return gstConfig;\n}\n\nexport { setConfig, getConfig };\n"],"file":"user-data.js"}