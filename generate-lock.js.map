{"version":3,"sources":["generate-lock.js"],"names":["templateDir","process","env","TEMPLATE_DIR","console","info","options","koaServer","senecaClient","senecaServer","model","Promise","map","option","tempDir","targetDir","Object","keys","join","builder","Builder","assign","disableLock","lockPath","isExists","run","catch","e","warn","exit"],"mappings":";;AAAA;;AACA;;AACA;;AACA;;AAEA;;;;AAEA,MAAMA,cAAcC,QAAQC,GAAR,CAAYC,YAAhC;AACAC,QAAQC,IAAR,CAAa,eAAb,EAA8BL,WAA9B;AAEA,IAAIM,UAAU,CACZ;AAAEC,aAAW;AAAb,CADY,EAEZ;AAAEA,aAAW,IAAb;AAAmBC,gBAAc;AAAjC,CAFY,EAGZ;AAAEC,gBAAc;AAAhB,CAHY,EAIZ;AAAEA,gBAAc,IAAhB;AAAsBD,gBAAc;AAApC,CAJY,EAKZ;AAAED,aAAW,IAAb;AAAmBG,SAAO;AAA1B,CALY,EAMZ;AAAEH,aAAW,IAAb;AAAmBC,gBAAc,IAAjC;AAAuCE,SAAO;AAA9C,CANY,EAOZ;AAAED,gBAAc,IAAhB;AAAsBC,SAAO;AAA7B,CAPY,EAQZ;AAAED,gBAAc,IAAhB;AAAsBD,gBAAc,IAApC;AAA0CE,SAAO;AAAjD,CARY,CAAd;;AAWAC,kBAAQC,GAAR,CAAYN,OAAZ,EAAqB,MAAOO,MAAP,IAAkB;AACrC,MAAIC,UAAU,mBAAYd,WAAZ,EAAyB,KAAzB,CAAd;AACA,MAAIe,YAAY,mBAAYD,OAAZ,EAAqBE,OAAOC,IAAP,CAAYJ,MAAZ,EAAoBK,IAApB,CAAyB,GAAzB,CAArB,CAAhB;AAEAd,UAAQC,IAAR,CAAa,UAAb,EAAyBQ,MAAzB;AACA,QAAMM,UAAU,IAAIC,gBAAJ,CAAYJ,OAAOK,MAAP,CAAcR,MAAd,EAAsB;AAChDb,eADgD;AAEhDe,aAFgD;AAGhDO,iBAAa;AAHmC,GAAtB,CAAZ,CAAhB;AAMA,QAAM,gBAAM,UAASP,SAAU,EAAzB,CAAN;AACA,MAAI;AAAEQ,YAAF;AAAYC;AAAZ,MAAyB,MAAM,wBAAYX,MAAZ,CAAnC;;AACA,MAAIW,QAAJ,EAAc;AACZ,UAAM,gBAAM,UAASD,QAAS,EAAxB,CAAN;AACD;;AAED,QAAMJ,QAAQM,GAAR,EAAN;AACArB,UAAQC,IAAR,CAAc,GAAEU,SAAU,gBAA1B;AACA,QAAM,gBAAM,MAAK,mBAAYA,SAAZ,EAAuB,WAAvB,CAAoC,IAAGQ,QAAS,EAA3D,CAAN;AACA,QAAM,gBAAM,UAASR,SAAU,EAAzB,CAAN;AACD,CArBD,EAqBGW,KArBH,CAqBUC,CAAD,IAAO;AACdvB,UAAQwB,IAAR,CAAaD,CAAb;AACA1B,UAAQ4B,IAAR,CAAa,CAAb;AACD,CAxBD","sourcesContent":["import Promise from 'bluebird';\nimport { resolve as pathResolve } from 'path';\nimport { exec } from './util';\nimport { getLockPath } from './yarn-lock/index';\n\nimport Builder from './Builder';\n\nconst templateDir = process.env.TEMPLATE_DIR;\nconsole.info('templateDir: ', templateDir);\n\nlet options = [\n  { koaServer: true },\n  { koaServer: true, senecaClient: true },\n  { senecaServer: true },\n  { senecaServer: true, senecaClient: true },\n  { koaServer: true, model: true },\n  { koaServer: true, senecaClient: true, model: true },\n  { senecaServer: true, model: true },\n  { senecaServer: true, senecaClient: true, model: true },\n];\n\nPromise.map(options, async (option) => {\n  let tempDir = pathResolve(templateDir, '../');\n  let targetDir = pathResolve(tempDir, Object.keys(option).join('-'));\n\n  console.info('option: ', option);\n  const builder = new Builder(Object.assign(option, {\n    templateDir,\n    targetDir,\n    disableLock: true,\n  }));\n\n  await exec(`rm -rf ${targetDir}`);\n  let { lockPath, isExists } = await getLockPath(option);\n  if (isExists) {\n    await exec(`rm -rf ${lockPath}`);\n  }\n\n  await builder.run();\n  console.info(`${targetDir} build success`);\n  await exec(`cp ${pathResolve(targetDir, 'yarn.lock')} ${lockPath}`);\n  await exec(`rm -rf ${targetDir}`);\n}).catch((e) => {\n  console.warn(e);\n  process.exit(1);\n});\n"],"file":"generate-lock.js"}